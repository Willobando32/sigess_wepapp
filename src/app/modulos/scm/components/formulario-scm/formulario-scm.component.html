<p-growl [value]="msgs"></p-growl>
<div class="p-d-flex p-mb-2 p-px-2 p-jc-end">
    <div *ngIf="caseSelect" class="case-data p-d-flex p-jc-between">
        <div class="case-code">
            <div class="title">Caso:</div>
            <div class="number">
                No. {{caseSelect.id}}
            </div>
        </div>
        <div class="case-date">
            creado el: {{caseSelect.fechaCreacion | date: 'dd/MM/yyyy'}}
        </div>
    </div>
</div>

<p-tabView styleClass="custom-panel">

    <p-tabPanel header="Información General">
        <form [formGroup]="empleadoForm" (ngSubmit)="onSubmit()">
            <div class="ui-g">
                <div class="ui-g-12">
                    <h5 class="title-header p-mb-2">Datos del trabajador involucrado</h5>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-autoComplete styleClass="form-material-autocomplete" #autocomplete placeholder="Digite"
                            [style]="{'width':'100%'}" (onSelect)="onSelection($event)" [suggestions]="empleadosList"
                            (completeMethod)="buscarEmpleado($event)" formControlName="numeroIdentificacion"
                            *ngIf="empleado?.id == null">
                            <ng-template let-empleado pTemplate="item">
                                <div class="ui-helper-clearfix">
                                    <div class="wrapper">
                                        <i *ngIf="!empleado.usuario?.icon" class="fa fa-user-circle"
                                            style="font-size: 48px;" aria-hidden="true"></i>
                                        <img *ngIf="empleado.usuario?.icon" [src]="empleado.usuario?.icon"
                                            style="border-radius: 50%;" #imgAvatar />
                                        <div style="margin-left:20px">
                                            <br /> {{empleado?.primerApellido}} {{empleado?.primerNombre}}
                                            {{empleado?.segundoNombre}}
                                            <br /> {{empleado?.numeroIdentificacion}}
                                            <br /> {{empleado?.usuario.email}}
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                        </p-autoComplete>
                        <label for="" class="active">Número de identificación</label>
                    </div>
                    <small *ngIf="pkUse.errors?.required && pkUse.touched" id="username2-help"
                        class="p-invalid">Requerido</small>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-dropdown [options]="tipoIdentificacionList" formControlName="tipoIdentificacion" required>
                        </p-dropdown>
                        <label for="" class="active">Tipo de identificación</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="text" pInputText [value]="nameAndLastName" placeholder="Apellidos y nombres"
                            class="form-material" id="" disabled="true" />
                        <label for="" class="active">Apellidos y nombres</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="text" pInputText formControlName="direccionGerencia"
                            placeholder="Dirección / Gerencia" class="form-material" id="" />
                        <label for="" class="active">Dirección / Gerencia</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="cargoList" formControlName="cargoId"
                            class="select-material" styleClass="select-material">
                        </p-dropdown>
                        <label for="" class="active">Cargo / Categoría</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <textarea class="textarea-material" pInputTextarea [value]="cargoDescripcion || ''"></textarea>
                        <label for="" class="active">Descripción del cargo</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-calendar [disabled]="true" [monthNavigator]="true" [yearNavigator]="true"
                            [yearRange]="yearRange" [maxDate]="fechaActual" [locale]="localeES" dateFormat="dd/mm/yy"
                            formControlName="fechaIngreso"></p-calendar>
                        <label for="" class="active">Fecha de vinculación</label>

                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="text" pInputText [value]="antiguedad || ''" placeholder="Antigüedad"
                            class="form-material" id="" [disabled]="true" />
                        <label for="" class="active">Antigüedad</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="text" pInputText [value]="range || ''" placeholder="Antigüedad"
                            class="form-material" id="" [disabled]="true" />
                        <label for="" class="active">Rango de antigüedad</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-calendar [disabled]="true" [monthNavigator]="true" [yearNavigator]="true"
                            [yearRange]="yearRange" [maxDate]="fechaActual" [locale]="localeES" dateFormat="dd/mm/yy">
                        </p-calendar>
                        <label for="" class="active">Fecha de desvinculación</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input pInputText formControlName="corporativePhone" styleClass="form-material">

                        <label for="" class="active">Teléfono corporativo</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="email" pInputText formControlName="email" placeholder="Correo corporativo"
                            class="form-material" id="" />
                        <label for="" class="active">Correo corporativo</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="text" pInputText formControlName="ciudadGerencia" placeholder="Regional"
                            class="form-material" id="" />
                        <label for="" class="active">Ciudad</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <area-selector formControlName="area"
                            [name]="this.empleadoSelect ? this.empleadoSelect.area.nombre:''" required></area-selector>
                        <label for="" class="active">Ubicación</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <label for="" class="active">Género</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <p-radioButton name="genero" value="M" label=" Masculino   ." formControlName="genero">
                        </p-radioButton>
                        <p-radioButton name="genero" value="F" label="Femenino" formControlName="genero">
                        </p-radioButton>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-calendar [disabled]="true" [monthNavigator]="true" [yearNavigator]="true"
                            [yearRange]="yearRange" [maxDate]="fechaActual" [locale]="localeES" dateFormat="dd/mm/yy"
                            formControlName="fechaNacimiento"></p-calendar>
                        <label for="" class="active">Fecha de nacimiento</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input [disabled]="true" type="text" pInputText [value]="edad" placeholder="Edad"
                            class="form-material" id="" />
                        <label for="" class="active">Edad</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input [disabled]="true" type="text" pInputText formControlName="regional"
                            placeholder="regional" class="form-material" id="" />
                        <label for="" class="active">Regional</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <s-ciudadSelector formControlName="ciudad" [id]="departamento" class="select-material"
                            styleClass="select-material">
                        </s-ciudadSelector>
                        <label for="" class="active">Ciudad de residencia</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <textarea class="textarea-material" formControlName="direccion"></textarea>
                        <label for="" class="active">Dirección de residencia</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <label for="" class="active">Zona de residencia</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <p-radioButton name="zonaResidencia" value="U" label=" Urbana   ."
                            formControlName="zonaResidencia">
                        </p-radioButton>
                        <p-radioButton name="zonaResidencia" value="R" label="Rural" formControlName="zonaResidencia">
                        </p-radioButton>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input pInputText formControlName="telefono1" class="form-material" styleClass="form-material">

                        <label for="" class="active">Teléfono personal</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input pInputText formControlName="telefono2" class="form-material" styleClass="form-material">

                        <label for="" class="active">Teléfono de residencia</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="email" pInputText formControlName="correoPersonal" plaholder="Correo personal" />
                        <label for="" class="active">Correo personal</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="epsList" formControlName="eps" class="select-material"
                            styleClass="select-material"></p-dropdown>
                        <label for="" class="active">EPS</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="afpList" formControlName="afp" class="select-material"
                            styleClass="select-material"></p-dropdown>
                        <label for="" class="active">AFP</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="epsList" formControlName="eps" class="select-material"
                            styleClass="select-material"></p-dropdown>
                        <label for="" class="active">ARL</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="text" pInputText formControlName="emergencyContact" placeholder="Regional"
                            class="form-material" id="" />
                        <label for="" class="active">Contacto de emergencia</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input pInputText formControlName="phoneEmergencyContact" class="form-material"
                            styleClass="form-material">

                        <label for="" class="active">Telefono de contacto de emergencia</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="email" pInputText formControlName="emailEmergencyContact"
                            placeholder="Correo corporativo" class="form-material" id="" />
                        <label for="" class="active">Correo de contacto de emergencia</label>
                    </div>
                </div>


            </div>
            <form [formGroup]="jefeInmediato">
                <div class="ui-g p-py-2">
                    <div class="ui-g-12">
                        <div class="ui-g-12">
                            <h5 class="title-header p-mb-2">Datos del jefe inmediato</h5>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <p-autoComplete styleClass="form-material-autocomplete" placeholder="Digite"
                                [style]="{'width':'100%'}" (onSelect)="onSelectionJefeInmediato($event)"
                                [suggestions]="empleadosList" (completeMethod)="buscarEmpleado($event)"
                                formControlName="numeroIdentificacion" *ngIf="empleado?.id == null">
                                <ng-template let-empleado pTemplate="item">
                                    <div class="ui-helper-clearfix">
                                        <div class="wrapper">
                                            <i *ngIf="!empleado.usuario?.icon" class="fa fa-user-circle"
                                                style="font-size: 48px;" aria-hidden="true"></i>
                                            <img *ngIf="empleado.usuario?.icon" [src]="empleado.usuario?.icon"
                                                style="border-radius: 50%;" #imgAvatar />
                                            <div style="margin-left:20px">
                                                <br />{{empleado?.primerApellido}} {{empleado?.primerNombre}}
                                                {{empleado?.segundoNombre}}

                                                <br /> {{empleado?.numeroIdentificacion}}
                                                <br /> {{empleado?.usuario.email}}
                                            </div>
                                        </div>
                                    </div>
                                </ng-template>
                            </p-autoComplete>
                            <label for="" class="active">Número de identificación</label>
                        </div>

                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <input type="text" pInputText formControlName="primerNombre"
                                placeholder="Apellidos y nombres" class="form-material" id="" />
                            <label for="" class="active">Apellidos y nombres</label>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <p-dropdown [filter]="true" [options]="cargoList" formControlName="cargoId"
                                class="select-material" styleClass="select-material">
                            </p-dropdown>
                            <label for="" class="active">Cargo / Categoría</label>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <input type="text" pInputText formControlName="direccionGerencia"
                                placeholder="Dirección / Gerencia" class="form-material" id="" />
                            <label for="" class="active">Dirección / Gerencia</label>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <input pInputText formControlName="corporativePhone" class="form-material"
                                styleClass="form-material">

                            <label for="" class="active">Número móvil corporativo</label>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <input type="text" pInputText formControlName="email" placeholder="Correo corporativo"
                                class="form-material" id="" />
                            <label for="" class="active">Correo corporativo</label>
                        </div>
                    </div>
                </div>
                <div style="text-align: center; width: 100%;">
                    <button pButton *ngIf="solicitando == false" (click)="submitEmp()" type="submit"
                        icon="fa fa-floppy-o" class="float-btn" style="bottom: 100px;"
                        title="Guardar datos de empleado"></button>

                    <p-progressSpinner *ngIf="solicitando == true" class="float-btn" strokeWidth="8"
                        [style]="{width: '35px', height: '35px'}"></p-progressSpinner>
                </div>
            </form>
            <form [formGroup]="bussinessParner">
                <div class="ui-g p-py-2">
                    <div class="ui-g-12">
                        <div class="ui-g-12">
                            <h5 class="title-header p-mb-2">Datos del Business Partner</h5>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <p-autoComplete styleClass="form-material-autocomplete" placeholder="Digite"
                                [style]="{'width':'100%'}" (onSelect)="onSelectionBP($event)"
                                [suggestions]="empleadosList" (completeMethod)="buscarEmpleado($event)"
                                formControlName="numeroIdentificacion" *ngIf="empleado?.id == null">
                                <ng-template let-empleado pTemplate="item">
                                    <div class="ui-helper-clearfix">
                                        <div class="wrapper">
                                            <i *ngIf="!empleado.usuario?.icon" class="fa fa-user-circle"
                                                style="font-size: 48px;" aria-hidden="true"></i>
                                            <img *ngIf="empleado.usuario?.icon" [src]="empleado.usuario?.icon"
                                                style="border-radius: 50%;" #imgAvatar />
                                            <div style="margin-left:20px">
                                                <br />{{empleado?.primerApellido}} {{empleado?.primerNombre}}
                                                {{empleado?.segundoNombre}}
                                                <br /> {{empleado?.numeroIdentificacion}}
                                                <br /> {{empleado?.usuario.email}}
                                            </div>
                                        </div>
                                    </div>
                                </ng-template>
                            </p-autoComplete>
                            <label for="" class="active">Número de identificación</label>
                        </div>

                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <input type="text" pInputText formControlName="primerNombre"
                                placeholder="Apellidos y nombres" class="form-material" id="" />
                            <label for="" class="active">Apellidos y nombres</label>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <p-dropdown [filter]="true" [options]="cargoList" formControlName="cargoId"
                                class="select-material" styleClass="select-material">
                            </p-dropdown>
                            <label for="" class="active">Cargo / Categoría</label>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <input type="text" pInputText formControlName="direccionGerencia"
                                placeholder="Dirección / Gerencia" class="form-material" id="" />
                            <label for="" class="active">Dirección / Gerencia</label>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <input pInputText formControlName="corporativePhone" class="form-material"
                                styleClass="form-material">

                            <label for="" class="active">Número móvil corporativo</label>
                        </div>
                    </div>
                    <div class="ui-g-12 ui-md-6 ui-lg-4">
                        <div class="input-field">
                            <input type="text" pInputText formControlName="email" placeholder="Correo corporativo"
                                class="form-material" id="" />
                            <label for="" class="active">Correo corporativo</label>
                        </div>
                    </div>
                </div>
            </form>
        </form>
    </p-tabPanel>

    <p-tabPanel *ngIf="empleadoSelect" header="Información Médica">




        <form *ngIf="createCase || caseSelect" [formGroup]="casoMedicoForm" (ngSubmit)="onSubmit()">
            <div class="ui-g">
                <div class="ui-g-12 ui-md-4 ui-lg-2">
                    <div class="input-field">
                        <input type="text" pInputText [value]="status" disabled="true">
                        <label for="" class="active">Estado del caso</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-4 ui-lg-2">
                    <div class="input-field">
                        <p-calendar [monthNavigator]="true" [yearNavigator]="true" [yearRange]="yearRange"
                            [maxDate]="fechaActual" [locale]="localeES" dateFormat="dd/mm/yy"
                            formControlName="fechaFinal"></p-calendar>
                        <label for="" class="active">Fecha de cierre</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-4 ui-lg-8">
                    <div class="input-field">
                        <textarea class="textarea-material" pInputTextarea formControlName="observaciones"></textarea>
                        <label for="" class="active">Observaciones</label>
                    </div>
                </div>
                <div class="ui-g-12 p-mb-2">
                    <h5 class="title-header">Información del caso</h5>
                </div>

                <div class="ui-g-12">
                    <div class="input-field">
                        <textarea class="textarea-material" pInputTextarea
                            formControlName="descripcionCompletaCaso"></textarea>
                        <label for="" class="active">Descripción completa del caso</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-4">
                    <div class="input-field">

                        <p-dropdown [options]="caseOptionList" formControlName="casoMedicoLaboral"
                            class="select-material" styleClass="select-material">
                        </p-dropdown>
                        <label for="" class="active">Caso de mesa laboral</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-4">
                    <div class="input-field">
                        <input type="text" pInputText formControlName="razon" placeholder="Motivo" class="form-material"
                            id="" />
                        <label for="" class="active">Motivo</label>
                    </div>
                </div>


                <div class="ui-g-12 ui-md-4">
                    <div class="input-field">
                        <p-dropdown [options]="pclOptionList" formControlName="pcl" class="select-material"
                            styleClass="select-material">
                        </p-dropdown>
                        <label for="" class="active">PCL</label>
                        {{casoMedicoForm.get('pcl').value}}
                    </div>
                </div>
                <div class="ui-g-6" *ngIf="casoMedicoForm.get('pcl').value != 0">
                    <button pButton type="button" (click)="fileInput.click()" icon="fa fa-plus" label="Adjuntar imágen"
                        [disabled]="disabled"></button>
                    <div *ngIf="loadingImg == true" style="width: 100%;text-align: center;margin-top: 20px;">
                        <p-progressSpinner strokeWidth="8" [style]="{width: '45px', height: '45px'}">
                        </p-progressSpinner>
                    </div>
                    <s-galeria *ngIf="imagenesList.length > 0" [images]="imagenesList"
                        (onRemove)="removerImagen($event)" [readOnly]="disabled"></s-galeria>
                    <input name="myFile" type="file" style="visibility: hidden;" #fileInput
                        (change)="onArchivoSelect($event)">
                </div>
                <div class="ui-g-12 ui-md-4" *ngIf="casoMedicoForm.get('pcl').value != 0">
                    <div class="input-field">
                        <input type="text" pInputText formControlName="porcentajePcl" placeholder="% de la PCL"
                            class="form-material" id="" />
                        <label for="" class="active">% de la PCL</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-4 ui-lg-2" *ngIf="casoMedicoForm.get('pcl').value != 0">
                    <div class="input-field">
                        <p-calendar [monthNavigator]="true" [yearNavigator]="true" [yearRange]="yearRange"
                            [maxDate]="fechaActual" [locale]="localeES" dateFormat="dd/mm/yy"
                            formControlName="emisionPclFecha"></p-calendar>
                        <label for="" class="active">Fecha de emisión de la PCL</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-4 ui-lg-6" *ngIf="casoMedicoForm.get('pcl').value != 0">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="cargoList" formControlName="pclEmitEntidad"
                            class="select-material" styleClass="select-material">
                        </p-dropdown>
                        <label for="" class="active">Entidad que emite la PCL</label>
                    </div>
                </div>


                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="cargoList" formControlName="statusDeCalificacion"
                            class="select-material" styleClass="select-material">
                        </p-dropdown>
                        <label for="" class="active">Estado de la calificación</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-2">
                    <div class="input-field">
                        <p-calendar [monthNavigator]="true" [yearNavigator]="true" [yearRange]="yearRange"
                            [maxDate]="fechaActual" [locale]="localeES" dateFormat="dd/mm/yy"
                            formControlName="fechaCalificacion"></p-calendar>
                        <label for="" class="active">Fecha de la calificación</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-12 ui-lg-6">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="cargoList" formControlName="entidadEmiteCalificacion"
                            class="select-material" styleClass="select-material">
                        </p-dropdown>
                        <label for="" class="active">Entidad que emite la calificación</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="text" pInputText formControlName="conceptRehabilitacion"
                            placeholder="Concepto de rehabilitación" class="form-material" id="" />
                        <label for="" class="active">Concepto de rehabilitación</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-2">
                    <div class="input-field">
                        <p-calendar [monthNavigator]="true" [yearNavigator]="true" [yearRange]="yearRange"
                            [maxDate]="fechaActual" [locale]="localeES" dateFormat="dd/mm/yy"
                            formControlName="fechaConceptRehabilitacion"></p-calendar>
                        <label for="" class="active">Fecha de concepto de rehabilitación</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-12 ui-lg-6">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="cargoList" formControlName="entidadEmiteConcepto"
                            class="select-material" styleClass="select-material">
                        </p-dropdown>
                        <label for="" class="active">Entidad que emite el concepto de
                            rehabilitación</label>
                    </div>
                </div>
            </div>

            <div class="ui-g p-py-2">
                <div class="ui-g-12">
                    <h5 class="title-header p-mb-2">Intervención complementaria</h5>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-dropdown [options]="caseOptionList" formControlName="requiereIntervencion"
                            class="select-material" styleClass="select-material">
                        </p-dropdown>
                        <label for="" class="active">Requiere intervención complementaria</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input type="text" pInputText formControlName="sve" placeholder="SVE" class="form-material"
                            id="" />
                        <label for="" class="active">SVE</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <textarea class="textarea-material" formControlName="professionalArea"
                            pInputTextarea></textarea>


                        <label for="" class="active">Área profesional</label>
                    </div>
                </div>

                <div class="ui-g-12">
                    <div class="input-field">
                        <textarea class="textarea-material" pInputTextarea></textarea>
                        <label for="" class="active">Justificación</label>
                    </div>
                </div>
            </div>

            <!--
           <div class="ui-g p-py-2">
                <div class="ui-g-12">
                    <h5 class="title-header p-mb-2">Recomendaciones</h5>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <input  type="text" pInputText formControlName="primerNombre"
                            placeholder="Se generan recomendaciones" class="form-material" id="" />
                        <label for="" class="active">Se generan recomendaciones</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-5">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="cargoList" formControlName="cargoId"
                            class="select-material" styleClass="select-material" >
                        </p-dropdown>
                        <label for="" class="active">Entidad que emite las recomendaciones</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-4 ui-lg-3">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="cargoList" formControlName="cargoId"
                            class="select-material" styleClass="select-material" >
                        </p-dropdown>
                        <label for="" class="active">Tipo</label>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-4 ui-lg-4">
                    <div class="input-field">
                        <p-calendar [monthNavigator]="true" [yearNavigator]="true" [yearRange]="yearRange"
                            [maxDate]="fechaActual" [locale]="localeES" dateFormat="dd/mm/yy"
                            formControlName="fechaNacimiento"></p-calendar>
                        <label for="" class="active">Fecha de expedición</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-4 ui-lg-4">
                    <div class="input-field">
                        <p-calendar [monthNavigator]="true" [yearNavigator]="true" [yearRange]="yearRange"
                            [maxDate]="fechaActual" [locale]="localeES" dateFormat="dd/mm/yy"
                            formControlName="fechaNacimiento"></p-calendar>
                        <label for="" class="active">Fecha de vencimiento</label>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4">
                    <div class="input-field">
                        <p-dropdown [filter]="true" [options]="cargoList" formControlName="cargoId"
                            class="select-material" styleClass="select-material" >
                        </p-dropdown>
                        <label for="" class="active">Estado</label>
                    </div>
                </div>
 
                <div class="ui-g-12">
                    <div class="input-field">
                        <textarea class="textarea-material" pInputTextarea formControlName="direccion"></textarea>
                        <label for="" class="active">Recomendaciones</label>
                    </div>
                </div>
            </div>-->
            <div style="text-align: center; width: 100%;">
                <button pButton *ngIf="solicitando == false" type="submit" icon="fa fa-floppy-o" class="float-btn"
                    style="bottom: 100px;" title="Guardar datos de empleado"></button>

                <p-progressSpinner *ngIf="solicitando == true" class="float-btn" strokeWidth="8"
                    [style]="{width: '35px', height: '35px'}"></p-progressSpinner>
            </div>
        </form>


        <p-table *ngIf="!caseSelect && !createCase" #dt [value]="casosList" (click)="onClick()" autoLayout="true"
            selectionMode="single" [(selection)]="casoSeleccionado" [rows]="10" (onLazyLoad)="lazyLoad($event)"
            [paginator]="true" dataKey="id" [lazy]="true">
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="id">No. Caso
                        <p-sortIcon field="id"></p-sortIcon>
                    </th>
                    <th pSortableColumn="fapertura">Fecha de apertura
                        <p-sortIcon field="fapertura"></p-sortIcon>
                    </th>
                    <th pSortableColumn="regional">Regional
                        <p-sortIcon field="regional"></p-sortIcon>
                    </th>
                    <th pSortableColumn="ciudad">Ciudad
                        <p-sortIcon field="ciudad"></p-sortIcon>
                    </th>
                    <th pSortableColumn="nameLastname">Nombre - Apellido
                        <p-sortIcon field="nameLastname"></p-sortIcon>
                    </th>
                    <th pSortableColumn="documento">Documento
                        <p-sortIcon field="documento"></p-sortIcon>
                    </th>

                    <th pSortableColumn="charge">Cargo
                        <p-sortIcon field="charge"></p-sortIcon>
                    </th>
                    <th pSortableColumn="statusCaso">Estado de caso
                        <p-sortIcon field="statusCaso"></p-sortIcon>
                    </th>
                    <th pSortableColumn="saludstate">Caso de mesa laboral
                        <p-sortIcon field="saludstate"></p-sortIcon>
                    </th>
                </tr>
                <tr>

                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-case>

                <tr [pSelectableRow]="case" class="table-row table-row-selectable">
                    <td>{{case.id}}</td>
                    <td>{{case.fechaCreacion | date: 'dd/MM/yyyy'}}</td>
                    <td>{{case.region}}</td>
                    <td>{{case.ciudad}}</td>
                    <td>{{case.pkUser.primerNombre}} {{case.pkUser.primerApellido}}</td>
                    <td>{{case.documento}}</td>
                    <td>{{case.cargo}}</td>
                    <td>{{case.statusCaso == 1 ? 'Abierto' : 'Cerrado'}}</td>
                    <td>{{case.casoMedicoLaboral  == 1 ? 'Si' : 'No'}}</td>

                </tr>
            </ng-template>
            <ng-template pTemplate="summary" let-rowData>
                <button *sTienePermiso="'ADM_POST_USR'" (click)="createCaso()" pButton type="button" icon="fa fa-plus"
                    [routerLink]="['/app/scm/creacion']" label="Crear Caso"></button>

                <button *sTienePermiso="'ADM_PUT_USR'" (click)="modifyCase()" pButton type="button" icon="fa fa-pencil"
                    label="Modificar" class="ui-button-success" [disabled]="!casoSeleccionado"></button>

                <button *sTienePermiso="'ADM_PUT_USR'" pButton type="button" icon="fa fa-pencil" label="Consultar"
                    class="ui-button-success" [disabled]="!casoSeleccionado"></button>
                <!--  <button *sTienePermiso="'ADM_DELETE_USR'" pButton type="button" icon="fa fa-trash" label="Eliminar" class="ui-button-danger"
            (click)="eliminar()" [disabled]="!usuarioSelect"></button>-->
            </ng-template>
        </p-table>

    </p-tabPanel>

    <p-tabPanel header="Diagnosticos" *ngIf="caseSelect">

        <p-table #dt [value]="diagnosticoList" autoLayout="true" selectionMode="single" [rows]="5" [paginator]="true"
            dataKey="id" [lazy]="true">
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="id"># Del caso
                        <p-sortIcon field="id"></p-sortIcon>
                    </th>
                    <th pSortableColumn="fapertura">CIE
                        <p-sortIcon field="fapertura"></p-sortIcon>
                    </th>
                    <th pSortableColumn="regional">Sistema Afectado
                        <p-sortIcon field="regional"></p-sortIcon>
                    </th>
                    <th pSortableColumn="ciudad">Diagnostico
                        <p-sortIcon field="ciudad"></p-sortIcon>
                    </th>

                </tr>
                <tr>

                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>


                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-case>

                <tr [pSelectableRow]="case" class="table-row table-row-selectable">
                    <td>{{case.pkCase}}</td>
                    <td>{{case.codigoCie10 }}</td>
                    <td>{{case.sistemaAfectado}}</td>
                    <td>{{case.diagnostico}}</td>

                </tr>
            </ng-template>
            <ng-template pTemplate="summary" let-rowData>
                <button *sTienePermiso="'ADM_POST_USR'" pButton type="button" icon="fa fa-plus"
                    (click)="modalDianostico = true">

                </button>

            </ng-template>
        </p-table>
    </p-tabPanel>
    <p-tabPanel header="Incapacidades" *ngIf="caseSelect">
        <div class="ui-g">
            <div class="ui-g-12">
                <h5 class="title-header p-mb-2">Información sobre incapacidades</h5>
            </div>
            <div class="ui-g-12">
                <!-- <p-table [columns]="cols" [value]="products" styleClass="p-datatable-responsive"> -->
                <p-table styleClass="p-datatable-responsive" [value]="incapacidades" [rows]="5" [paginator]="true"
                    dataKey="id" [lazy]="true">
                    <ng-template pTemplate="header">
                        <tr>
                            <th pSortableColumn="fechaDesde">Fecha Inicio
                                <p-sortIcon field="fechaDesde"></p-sortIcon>
                            </th>
                            <th pSortableColumn="fechaHasta">Fecha Hasta
                                <p-sortIcon field="fechaHasta"></p-sortIcon>
                            </th>
                            <th pSortableColumn="diasAusencia">Dias de incapacidad
                                <p-sortIcon field="diasAusencia"></p-sortIcon>
                            </th>
                            <th pSortableColumn="causaAusentismo">Tipo
                                <p-sortIcon field="ausaAusentismo"></p-sortIcon>
                            </th>
                            <th pSortableColumn="cie">Codigo CIE 10
                                <p-sortIcon field="cie"></p-sortIcon>
                            </th>
                            <th pSortableColumn="documento">Diagnostico
                                <p-sortIcon field="documento"></p-sortIcon>
                            </th>


                        </tr>

                    </ng-template>
                    <ng-template pTemplate="body" let-aus *ngIf="incapacidades.length>0">

                        <tr [pSelectableRow]="aus" class="table-row table-row-selectable">
                            <td>{{aus.fechaDesde | date}}</td>

                            <td>{{aus.fechaHasta | date}}</td>

                            <td>{{aus.diasAusencia}}</td>

                            <td>{{aus.causaAusentismo.nombre}}</td>

                            <td>{{aus.cie.codigo }}</td>

                            <td>{{aus.cie.nombre }}</td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="summary" let-rowData>
                        <button pButton type="button" [queryParams]="{case: caseSelect.id}"
                            [routerLink]="['/app/aus/reporteAusentismo']" icon="fa fa-plus">

                        </button>

                    </ng-template>
                </p-table>
            </div>

        </div>

    </p-tabPanel>
    <p-tabPanel header="Seguimiento" *ngIf="caseSelect">

        <div class="card">
            <h5>Seguimiento de caso</h5>
            <p-table [value]="seguimientos" dataKey="id" editMode="row">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Fecha de seguimiento</th>
                        <th>Seguimiento</th>
                        <th>Tarea</th>
                        <th>Responsable</th>
                        <th>Resultado</th>

                        <th style="width:8rem"></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-seguimiento let-editing="editing" let-ri="rowIndex">
                    <tr [pEditableRow]="seguimiento">
                        <td>
                            <p-cellEditor>
                                <ng-template pTemplate="input">
                                    <p-calendar [(ngModel)]="seguimiento.fechaSeg" placeholder="mm/dd/yyyy"
                                        [locale]="localeES">
                                    </p-calendar>

                                </ng-template>
                                <ng-template pTemplate="output">
                                    {{seguimiento.fechaSeg | date}}
                                </ng-template>
                            </p-cellEditor>
                        </td>
                        <td>
                            <p-cellEditor>
                                <ng-template pTemplate="input">
                                    <input pInputText type="text" [(ngModel)]="seguimiento.seguimiento">
                                </ng-template>
                                <ng-template pTemplate="output">
                                    {{seguimiento.seguimiento}}
                                </ng-template>
                            </p-cellEditor>
                        </td>
                        <td>
                            <p-cellEditor>
                                <ng-template pTemplate="input">
                                    <input pInputText type="text" [(ngModel)]="seguimiento.tarea">
                                </ng-template>
                                <ng-template pTemplate="output">
                                    {{seguimiento.tarea}}
                                </ng-template>
                            </p-cellEditor>
                        </td>
                        <td>
                            <p-cellEditor>
                                <ng-template pTemplate="input">
                                    <p-autoComplete styleClass="form-material-autocomplete" #autocomplete
                                        placeholder="Digite" [style]="{'width':'100%'}"
                                        (onSelect)="seguimiento.responsable = $event" [suggestions]="empleadosList"
                                        (completeMethod)="buscarEmpleado($event)" field="primerNombre"
                                        [(ngModel)]="seguimiento.responsable" *ngIf="empleado?.id == null">
                                        <ng-template let-empleado pTemplate="item">
                                            <div class="ui-helper-clearfix">
                                                <div class="wrapper">
                                                    <i *ngIf="!empleado.usuario?.icon" class="fa fa-user-circle"
                                                        style="font-size: 48px;" aria-hidden="true"></i>
                                                    <img *ngIf="empleado.usuario?.icon" [src]="empleado.usuario?.icon"
                                                        style="border-radius: 50%;" #imgAvatar />
                                                    <div style="margin-left:20px">
                                                        <label>{{empleado?.primerApellido}} {{empleado?.primerNombre}}
                                                            {{empleado?.segundoNombre}}
                                                        </label>
                                                        <br /> {{empleado?.numeroIdentificacion}}
                                                        <br /> {{empleado?.usuario.email}}
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>
                                    </p-autoComplete>
                                </ng-template>
                                <ng-template pTemplate="output">
                                    {{seguimiento.responsable?.primerNombre }}
                                </ng-template>
                            </p-cellEditor>
                        </td>
                        <td>
                            <p-cellEditor>
                                <ng-template pTemplate="input">
                                    <input pInputText type="text" [(ngModel)]="seguimiento.resultado">
                                </ng-template>
                                <ng-template pTemplate="output">
                                    {{seguimiento.resultado}}
                                </ng-template>
                            </p-cellEditor>
                        </td>
                        <td style="text-align:center">
                            <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                                (click)="onRowEditInit(seguimiento)" class="p-button-rounded p-button-text"></button>
                            <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
                                (click)="onRowEditSave(seguimiento)"
                                class="p-button-rounded p-button-text p-button-success p-mr-2"></button>
                            <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"
                                (click)="onRowEditCancel(seguimiento, ri)"
                                class="p-button-rounded p-button-text p-button-danger"></button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="summary" let-rowData>
                    <button *sTienePermiso="'ADM_POST_USR'" pButton type="button" icon="fa fa-plus"
                        (click)="nuevoSeguimiento()">

                    </button>

                </ng-template>
            </p-table>
        </div>
    </p-tabPanel>


    <p-tabPanel header="Recomendaciones" *ngIf="caseSelect">

        <p-table #dt [value]="recomendationList" autoLayout="true" selectionMode="single" [rows]="5" [paginator]="true"
            dataKey="id" [lazy]="true">
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="id">Entidad emisora
                        <p-sortIcon field="id"></p-sortIcon>
                    </th>
                    <th pSortableColumn="fapertura">Tipo
                        <p-sortIcon field="fapertura"></p-sortIcon>
                    </th>
                    <th pSortableColumn="regional">Estado
                        <p-sortIcon field="regional"></p-sortIcon>
                    </th>
                    <th pSortableColumn="ciudad">Recomendación
                        <p-sortIcon field="ciudad"></p-sortIcon>
                    </th>
                    <th pSortableColumn="nameLastname">Fecha inicial
                        <p-sortIcon field="nameLastname"></p-sortIcon>
                    </th>
                    <th pSortableColumn="documento">Fecha final
                        <p-sortIcon field="documento"></p-sortIcon>
                    </th>

                    <th pSortableColumn="charge">Recomendación generada
                        <p-sortIcon field="charge"></p-sortIcon>
                    </th>

                </tr>
                <tr>

                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>
                    <td>
                        <input pInputText type="text" (input)="dt.filter($event.target.value, 'estado', 'contains')">
                    </td>

                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-case>

                <tr [pSelectableRow]="case" class="table-row table-row-selectable">
                    <td>{{case.entidadEmitRecomendaciones}}</td>
                    <td>{{case.tipo }}</td>
                    <td>{{case.status}}</td>
                    <td>{{case.recomendaciones}}</td>
                    <td>{{case.fechaInicio | date:'dd/MM/yyyy HH:mm'}}</td>
                    <td>{{case.fechaExpiracion | date:'dd/MM/yyyy HH:mm'}}</td>
                    <td>{{case.generateRecomendaciones}}</td>


                </tr>
            </ng-template>
            <ng-template pTemplate="summary" let-rowData>
                <button *sTienePermiso="'ADM_POST_USR'" pButton type="button" icon="fa fa-plus"
                    (click)="modalRecomendatios = true">

                </button>

            </ng-template>
        </p-table>
    </p-tabPanel>

    <p-tabPanel header="Trazabilidad" *ngIf="caseSelect">

        <p-table #dt [value]="logsList" autoLayout="true" selectionMode="single" [rows]="5" [(selection)]="logSelected"
            [paginator]="true" dataKey="id" [lazy]="true">
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="id">Accion
                        <p-sortIcon field="id"></p-sortIcon>
                    </th>
                    <th pSortableColumn="fapertura">Fecha
                        <p-sortIcon field="fapertura"></p-sortIcon>
                    </th>
                    <th pSortableColumn="regional">Lugar del cambio
                        <p-sortIcon field="regional"></p-sortIcon>
                    </th>
                    <th pSortableColumn="ciudad">Documento de quien cambio
                        <p-sortIcon field="ciudad"></p-sortIcon>
                    </th>


                </tr>

            </ng-template>
            <ng-template pTemplate="body" let-case>

                <tr [pSelectableRow]="case" class="table-row table-row-selectable">
                    <td>{{case.action}}</td>
                    <td>{{case.fecha_creacion | date:'dd/MM/yyyy HH:mm' }}</td>
                    <td>{{case.entity}}</td>
                    <td>{{case.recomendaciones}}</td>



                </tr>
            </ng-template>

        </p-table>
    </p-tabPanel>

</p-tabView>




<p-dialog header="Persistencia de datos" *ngIf="logSelected" [(visible)]="logSelected" [style]="{width: '50vw'}"
    [baseZIndex]="10000">
    <app-logmodal *ngIf="logsList" [log]="logSelected" [logList]="logsList">
    </app-logmodal>
</p-dialog>


<p-dialog header="Crear Diagnostico" *ngIf="caseSelect" [(visible)]="modalDianostico" [style]="{width: '50vw'}"
    [baseZIndex]="10000">

    <app-diagnostico-form *ngIf="caseSelect" [id]="caseSelect.pkUser.id" [caseId]="caseSelect.id"
        (eventClose)="onCloseModalDianostico()">

    </app-diagnostico-form>

</p-dialog>


<p-dialog header="Crear Recomendacion" *ngIf="caseSelect" [(visible)]="modalRecomendatios" [style]="{width: '50vw'}"
    [baseZIndex]="10000">
    <app-recomendationsform [id]="caseSelect.id" (eventClose)="onCloseModalrecomendation()">
    </app-recomendationsform>
</p-dialog>

<button pButton *ngIf="solicitando == false" type="button" [routerLink]="['/app/scm/list']" icon="fa fa-chevron-left"
    class="float-btn" (click)="closeForm()" title="Volver a listado de empleados"></button>